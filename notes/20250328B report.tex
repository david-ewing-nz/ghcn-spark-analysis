
\documentclass[11pt]{article}
\usepackage[a4paper,margin=2.5cm]{geometry}

\usepackage{graphicx}
\usepackage{float}
\usepackage{booktabs}
\usepackage{fontspec}
\usepackage{longtable}
\usepackage{array}
\usepackage{caption}
\usepackage{listings}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage{datetime2}
\usepackage{float}
\usepackage{placeins}
\usepackage{appendix}
\usepackage[style=apa,backend=biber]{biblatex}
\addbibresource{ghcnd.bib}
\setmainfont{Arial} % Or another sans-serif font you’re using
\linespread{1.0}
\setlength{\parskip}{0.5em}
\setlength{\parindent}{0pt}

\newcolumntype{L}[1]{>{\raggedright\arraybackslash}p{#1}}


\newcommand{\customtitle}{
    \begin{center}
        \vspace*{3cm}
        
        {\Large\textsf{\textbf{DATA420-25S2(C)}}}\\
        \vspace{0.3cm} 
        {\large\textsf{\textbf{Assignment 1}}}\\
        \vspace{5cm}
        {\Large\textsf{\textbf{GHCN Data Analysis using Spark}}}\\
        \vfill
        {\large David Ewing (82171165)\par}
        \vspace{0.3cm}
       % \DTMsetdatestyle{yyyymmdd}
        \DTMsetdatestyle{iso}
        {\large\textsf{ \DTMnow}}\\
        
        \vspace{3cm}
    \end{center}
    \thispagestyle{empty}
}

\begin{document}


\renewcommand{\familydefault}{\sfdefault}
\customtitle
\renewcommand{\familydefault}{\sfdefault}
\newpage 

\setmonofont{Consolas}
\begin{verbatim}
Hello ├── test
\end{verbatim}
\setmonofont{Courier New}
\cite{testentry}

\section{Analysis of the GHCN-Daily Dataset} 
\subsection{Q1(a), Data Structure }
\FloatBarrier
The dataset is stored in an Azure Blob Storage container named \texttt{ghcnd}, structured using virtual directories. As shown in Figure~\ref{fig-azure-url}, each file path follows the format:

\begin{center}
    \url{wasbs://campus-data@madsstorage002.blob.core.windows.net/ghcnd/daily/2025.csv.gz}
    \end{center}

    Within the \texttt{ghcnd} container: :
    \begin{itemize}
        \item Metadata files in the root are  \texttt{stations.txt}, \texttt{states.txt}, \texttt{countries.txt}, and\\ \texttt{inventory.txt},
        \item The main subdirectory is \texttt{daily} which holds 264 compressed \texttt{.csv.gz} file, 
        \item Each compressed files  holds the daily records for one year, 
        \item The records span 1750 to 2025 with 12 years data missing. 
    \end{itemize}
    The layout is illustrated in Figure~\ref{fig-ghcnd-tree}, showing a tree-like directory structure with yearly files nested under \texttt{daily}.

\bigskip

\begin{figure}[H]
    \centering
    \fbox{%
      \begin{minipage}{0.4\textwidth}
\texttt{%
\\
ghcnd\\
├── daily\\
│   ├── 1750.csv.gz\\
│   ├── 1751.csv.gz\\
│   ├── \ldots\\
│   ├── 2024.csv.gz\\
│   └── 2025.csv.gz\\
├── countries.txt\\
├── inventory.txt\\
├── states.txt\\
└── stations.txt
}
\end{minipage}
}
\caption{Azure Blob Storage GHCND directory structure }
\label{fig-ghcnd-tree}
\end{figure}
\begin{figure}[htbp]
    \centering
    \begin{minipage}{0.7\textwidth}
    \centering
\begin{tabular}{@{}L{0.42\textwidth} L{0.12\textwidth} L{0.43\textwidth}@{}}
\toprule
\textbf{Component} & \textbf{Type} & \textbf{Description} \\
\midrule
\texttt{wasbs://} & Protocol & Azure Blob Storage over SSL (used with Hadoop-compatible connectors)\par \\
\texttt{campus-data} & Container & Like a top-level directory within the blob storage account\par \\
\texttt{madsstorage002} & Storage account\par & The Azure storage account name \\
\texttt{blob.core.windows.net} & Service domain\par & Azure’s blob service endpoint domain \\
\texttt{/ghcnd/daily/2024.csv.gz} & Path & Virtual directory and file structure within the container\par \\
\texttt{ghcnd} & Container name\par & \texttt{<container>} \\
\texttt{daily} & Optional folder(s) within container\par & \texttt{<directory>}\\
\texttt{2024.csv.gz} & Blob name (file) &  \texttt{<filename>} \\
\bottomrule
\end{tabular}
\caption{Structure of a `wasbs://` Azure Blob Storage URI used for GHCN-Daily datasets}
\label{fig-azure-url}
\end{minipage}
\end{figure}
\bigskip


\section*{Directory Structure of \texttt{ghcnd/}}

The \texttt{daily/} folder contains yearly data files in compressed CSV format:

\bigskip
\noindent The \texttt{daily/} folder contains yearly data files in compressed CSV format:


\section{Background}

In this paragraph you should give a brief overview of what you are doing in the assignment including any useful links or references to background material and a high level description of any difficulties that you had.

\section{Processing}

In this paragraph you should describe the structure and content of the data and provide references for discussion in the sections below. You should describe the steps that you took to load, join, and check the data and discuss anything that you discovered along the way, but you should not include outputs other than answers to the questions that you have been asked.

\section{Analysis}

In this paragraph you should answer the questions that you have been asked, give a high level summary of what you have done, and discuss any insights that you had. You should not list answers you have not explained. You should talk about any tasks that you were unable to complete and explain why.

\section{Visualizations}

In this paragraph you should answer the questions, present your visualizations, give a high level summary of what you have done, and discuss any insights that you had. You should talk about any visualizations that you were unable to generate and why.

\section{Conclusions}

In this paragraph you should give a brief overview of what you have achieved and what you have learned.

\section{References}

\begin{itemize}
    \item Include all references that you have used or cited in the report. Use a consistent citation style such as APA or MLA.
    \item Include links to any online resources, datasets, libraries, or documentation.
    \item Clearly indicate any use of generative AI tools such as ChatGPT or Grammarly.
\end{itemize}











\printbibliography

\newpage

\begin{appendices}

\end{appendices}

\end{document}
